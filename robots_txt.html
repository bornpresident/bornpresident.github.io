import React, { useState, useRef, useEffect } from 'react';

const Terminal = () => {
  const [input, setInput] = useState('');
  const [history, setHistory] = useState(['Welcome to VishalOS v1.0.0', 'Type "help" for available commands']);
  const inputRef = useRef(null);
  const terminalRef = useRef(null);

  const commands = {
    help: () => `Available commands:
    ls              - List all available sections
    clear           - Clear terminal
    education       - Show education details
    skills          - Display technical skills
    projects        - List all projects
    achievements    - Show achievements and certifications
    experience      - Show work experience
    whoami          - Display basic info
    contact         - Show contact information`,

    ls: () => `Directories:
    ðŸ“ education/
    ðŸ“ skills/
    ðŸ“ projects/
    ðŸ“ achievements/
    ðŸ“ experience/
    ðŸ“ contact/`,

    education: () => `[*] EDUCATION RECORDS:
    
    > M.Sc. Cyber Security & Digital Forensics
      â””â”€ Rashtriya Raksha University (RRU)
      â””â”€ 2022 - 2024
    
    > Bachelors of Computer Application (BCA)
      â””â”€ Panjab University
      â””â”€ 2018 - 2021
    
    > Higher Secondary
      â””â”€ Kendriya Vidyalaya High Grounds
      â””â”€ 2018`,

    skills: () => `[*] TECHNICAL CAPABILITIES:
    
    > Primary Skills:
      â””â”€ Malware Analysis
      â””â”€ Information Security
      â””â”€ Threat Hunting
      â””â”€ Memory Forensics
      â””â”€ VAPT
      â””â”€ Security Operations
    
    > Programming:
      â””â”€ Python
      â””â”€ Rust
      â””â”€ Bash scripting
      â””â”€ C/C++
      â””â”€ Java`,

    projects: () => `[*] PROJECT DATABASE:
    
    > Moving Target Defense (MTD)
      â””â”€ Active ransomware defense system
      â””â”€ Dynamic file extension randomization
    
    > The Deepfake Slayer
      â””â”€ 2nd position nationally
      â””â”€ Prize: â‚¹50,000
      â””â”€ Accuracy: 92% image, 90% video, 87% audio
    
    > Dependence Aware Linux Kernel Fuzzer
      â””â”€ 1st position in Cython 2024
      â””â”€ Prize: â‚¹3,00,000
    
    > Malicious QR Code Detector
      â””â”€ Browser plugin for Cyber-THON 2023`,

    achievements: () => `[*] ACHIEVEMENTS AND CERTIFICATIONS:
    
    > Speaking Engagements:
      â””â”€ DEFCON Delhi Speaker
      â””â”€ IIT Bombay Speaker
    
    > Certifications:
      â””â”€ NCC "C" Certificate (A grade)
      â””â”€ ISO/IEC 27001 Information Security Associate
      â””â”€ Zscaler Cybersecurity Fundamental Associate
      â””â”€ OSINT Fundamentals by TCM Security`,

    experience: () => `[*] OPERATIONAL HISTORY:
    
    > IIT Bombay (Current)
      â””â”€ Software Engineer (Cyber Security)
      â””â”€ ML/LLM Security Research
    
    > NCIIPC, NTRO
      â””â”€ Cyber Security Intern
      â””â”€ Malware Analysis & Threat Detection
    
    > Pre-Doctoral Research
      â””â”€ Security Operations Centre Development
      â””â”€ Moving Target Defense Research`,

    whoami: () => `[*] IDENTITY CONFIRMED:
    
    > Vishal Chand
      â””â”€ Cyber Security Engineer
      â””â”€ Malware Analyst
      â””â”€ Security Researcher`,

    contact: () => `[*] SECURE COMMUNICATION CHANNELS:
    
    > Email: vishalchand20016@gmail.com
    > Phone: +91-7717363942
    > Professional: LinkedIn
    > Code: Github`,

    clear: () => {
      setHistory([]);
      return '';
    }
  };

  const handleCommand = (cmd) => {
    const trimmedCmd = cmd.trim().toLowerCase();
    if (trimmedCmd in commands) {
      return commands[trimmedCmd]();
    }
    return `Command not found: ${cmd}. Type "help" for available commands.`;
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (!input.trim()) return;

    const newHistory = [
      ...history,
      `root@kali:~$ ${input}`,
      handleCommand(input)
    ];
    setHistory(newHistory);
    setInput('');
  };

  useEffect(() => {
    if (terminalRef.current) {
      terminalRef.current.scrollTop = terminalRef.current.scrollHeight;
    }
  }, [history]);

  return (
    <div className="bg-black text-green-400 p-4 rounded-lg border border-green-500 font-mono h-[600px] overflow-hidden">
      <div className="flex items-center justify-between mb-2 border-b border-green-500 pb-2">
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded-full bg-red-500"></div>
          <div className="w-3 h-3 rounded-full bg-yellow-500"></div>
          <div className="w-3 h-3 rounded-full bg-green-500"></div>
        </div>
        <div className="text-sm">VishalOS Terminal</div>
      </div>
      
      <div ref={terminalRef} className="h-[520px] overflow-y-auto mb-2">
        {history.map((line, i) => (
          <pre key={i} className="whitespace-pre-wrap mb-1">{line}</pre>
        ))}
      </div>
      
      <form onSubmit={handleSubmit} className="flex items-center">
        <span className="mr-2">root@kali:~$</span>
        <input
          ref={inputRef}
          type="text"
          value={input}
          onChange={(e) => setInput(e.target.value)}
          className="flex-1 bg-transparent outline-none border-none"
          autoFocus
        />
      </form>
    </div>
  );
};

export default Terminal;
